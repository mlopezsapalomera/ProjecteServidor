<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Vista Usuaris</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="../styles/styles.css">
</head>
<body>
    <div class="container">
        <a href="../index.php" class="btn btn-secondary my-3">Tornar a l'índex</a>
        <div class="table-container">
            <h2>Llista d'Usuaris</h2>
            <div id="usuaris-container">
                <!-- El contenido se cargará aquí desde vistaUsuaris.controller.php -->
            </div>
        </div>
    </div>
    <script>
        function loadUsuaris() {
            fetch('../controllers/vistausuaris.controller.php')
                .then(response => response.text())
                .then(data => {
                    document.getElementById('usuaris-container').innerHTML = data;
                });
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadUsuaris();
        });

        document.getElementById('usuaris-container').addEventListener('click', (event) => {
            if (event.target.tagName === 'BUTTON' && event.target.classList.contains('delete-user')) {
                const userId = event.target.getAttribute('data-user-id');
                if (confirm('Seguro que deseas eliminar este usuario?')) {
                    fetch(`../controllers/eliminarUsuario.controller.php?id=${userId}`, { method: 'DELETE' })
                        .then(response => response.text())
                        .then(data => {
                            alert(data);
                            loadUsuaris();
                        });
                }
            }
        });
    </script>
</body>
</html>